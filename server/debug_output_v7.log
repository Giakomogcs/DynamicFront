=== Debugging Executor Live ===

1. Fetching Tools...
[ToolService] Fetching all tools...
[API Handler] Validating/Fetching spec: https://api.aprendizagem-busca-curso.dev.senai.br/api/docs-json
[API Handler] Spec fetched successfully: https://api.aprendizagem-busca-curso.dev.senai.br/api/docs-json
[API Handler] Resolved Effective Base URL for 'DN': https://api.aprendizagem-busca-curso.dev.senai.br
Available Tools: 57
 - register_api: Register a new API. Can provide OpenAPI Spec URL O...
 - register_db: Register a new Database....
 - dn_authcontroller_session: Login de Usuário...
 - dn_usercontroller_inputuser: Inserir usuários via Excel...
 - dn_usercontroller_sendemailuser: Enviar e-mail para os usuários...
 - dn_usercontroller_createuser: Criar usuários...
 - dn_usercontroller_updateuser: Atualizar usuários...
 - dn_usercontroller_changestatususer: Inativar / ativar usuários...
 - dn_usercontroller_listuser: Listar usuários...
 - dn_usercontroller_viewuser: Dados do usuários...
 - dn_usercontroller_deleteuser: Deleta usuários...
 - dn_companiescontroller_getcompanyprofile: Obter perfil consolidado da empresa...
 - dn_companiescontroller_getcourserecommendations: Obter recomendações de cursos por CNAEs...
 - dn_companiescontroller_getsenaiunits: Listar unidades SENAI...
 - dn_coursescontroller_getcoursedetails: Detalhes de um curso específico...
 - dn_coursescontroller_searchorderrecommendedcourses: Buscar cursos recomendados por localização...
 - dn_schoolscontroller_getshools: Lista escolas disponíveis...
 - dn_schoolscontroller_getschoolsbysenaiuser: Lista escolas com base no usuário...
 - dn_schoolscontroller_getfilters: Retorna os filtros disponíveis...
 - dn_recreateschoolscontroller_recreateshools: Recriar as escolas no banco de dados...
 - dn_quotacontroller_manualquotacalculation: Calcula a cota manualmente...
 - dn_quotacontroller_updatequota: Atualiza os dados de uma cota de aprendizagem de u...
 - dn_quotacontroller_findquota: Encontra os dados de uma cota de aprendizagem de u...
 - dn_cbofamilycontroller_findcbo: Lista as famílias CBO...
 - dn_enterprisecontroller_getenterprise: Busca dados de uma empresa...
 - dn_enterprisecontroller_listenterprise: Listar empresas...
 - dn_requestcontroller_createrequest: Solicitação de interesse em cursos...
 - dn_requestcontroller_viewrequest: Visualizar a solicitação de interesse em cursos...
 - dn_requestcontroller_listrequest: Lista as solicitações de interesse em cursos...
 - dn_requestcontroller_responserequest: Responder a solicitação de interesse em cursos...
 - dn_dashboardcontroller_getkpis: Kpis do dashboard...
 - dn_dashboardcontroller_getevolutionlearners: Evolução de aprendizagem...
 - dn_dashboardcontroller_getcontractscapacity: Capacidade X contratos...
 - dn_dashboardcontroller_getcompaniesserved: Empresas atendidas...
 - dn_dashboardcontroller_getcnaebystate: CNAEs atendidos por estado...
 - dn_dashboardcontroller_getrequestinterests: Empresas interessadas...
 - dn_dashboardcontroller_gettotalrequests: Total de solicitações de empresas interessadas...
 - dn_dashboardcontroller_getrequestsbylocation: Localização dos interessadas...
 - dn_dashboardcontroller_getresponsetime: Tempo de resposta para empresas interessadas...
 - dn_dashboardcontroller_gettopcourses: Top 10 cursos mais requisitados...
 - dn_dashboardcontroller_getcoursesstatus: Status de cursos aprovados e vencidos...
 - dn_dashboardcontroller_getquotaandcontactsummary: Resumo de cotas e contatos...
 - dn_dashboardcontroller_getindustrialpotential: Potencial industrial por cidade...
 - dn_dashboardcontroller_getcitieswithoutschools: Cidades sem unidade SENAI com solicitações...
 - dn_dashboardcontroller_gettopcourseswithoutschools: Top 5 cursos solicitados em cidades sem unidade SE...
 - dn_dashboardcontroller_gettimelinewithoutschools: Linha do tempo mensal de solicitações sem unidade ...
 - dn_dashboardcontroller_getcitieswithindustries: Cidades com indústrias mas sem unidade SENAI...
 - dn_dashboardcontroller_getevasionsummary: Resumo de potencial industrial em cidades sem unid...
 - dn_dashboardunitadmcontroller_getactivecontractsbyunit: Contratos ativos na unidade...
 - dn_dashboardunitadmcontroller_getactivecontractsbyentrydate: Contratos ativos por data de entrada...
 - dn_dashboardunitadmcontroller_getexpiringcontracts: Contratos vencendo...
 - dn_dashboardunitadmcontroller_getcompanieswithrequests: Empresas que enviaram solicitações...
 - dn_dashboardunitadmcontroller_getrequestedcourses: Cursos solicitados...
 - dn_dashboardunitadmcontroller_getactivecontractstimeline: Timeline de contratos ativos...
 - dn_analyticscontroller_logrecommendation: Registrar recomendação gerada...
 - dn_analyticscontroller_checkbias: Verificar viés em recomendações...
 - dn_analyticscontroller_getbiassignals: Listar sinais de viés...

2. Running Executor with query: "quais cursos tem em diadema?"
[Executor] Starting execution with 57 tools. Model: gemini-2.0-flash
[ModelManager] Initialized.
[ModelManager] Generating content with gemini-2.0-flash (Provider: gemini)...
[ModelManager] Primary execution failed for gemini-2.0-flash. Error: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent: [400 Bad Request] Invalid value at 'tools[0].function_declarations[15].parameters.properties[6].value.items.required' (TYPE_STRING), false
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[15].parameters.properties[6].value.items.items': Cannot find field.
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[26].parameters.properties[7].value.items': Cannot find field.
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[54].parameters.properties[3].value.items': Cannot find field. [{"@type":"type.googleapis.com/google.rpc.BadRequest","fieldViolations":[{"field":"tools[0].function_declarations[15].parameters.properties[6].value.items.required","description":"Invalid value at 'tools[0].function_declarations[15].parameters.properties[6].value.items.required' (TYPE_STRING), false"},{"field":"tools[0].function_declarations[15].parameters.properties[6].value.items.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[15].parameters.properties[6].value.items.items': Cannot find field."},{"field":"tools[0].function_declarations[26].parameters.properties[7].value.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[26].parameters.properties[7].value.items': Cannot find field."},{"field":"tools[0].function_declarations[54].parameters.properties[3].value.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[54].parameters.properties[3].value.items': Cannot find field."}]}]
[ModelManager] Error was not identified as Rate Limit/Quota. Rethrowing.
[Executor] Error in execution loop: GoogleGenerativeAIFetchError: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent: [400 Bad Request] Invalid value at 'tools[0].function_declarations[15].parameters.properties[6].value.items.required' (TYPE_STRING), false
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[15].parameters.properties[6].value.items.items': Cannot find field.
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[26].parameters.properties[7].value.items': Cannot find field.
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[54].parameters.properties[3].value.items': Cannot find field. [{"@type":"type.googleapis.com/google.rpc.BadRequest","fieldViolations":[{"field":"tools[0].function_declarations[15].parameters.properties[6].value.items.required","description":"Invalid value at 'tools[0].function_declarations[15].parameters.properties[6].value.items.required' (TYPE_STRING), false"},{"field":"tools[0].function_declarations[15].parameters.properties[6].value.items.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[15].parameters.properties[6].value.items.items': Cannot find field."},{"field":"tools[0].function_declarations[26].parameters.properties[7].value.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[26].parameters.properties[7].value.items': Cannot find field."},{"field":"tools[0].function_declarations[54].parameters.properties[3].value.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[54].parameters.properties[3].value.items': Cannot find field."}]}]
    at handleResponseNotOk (file:///Users/giovanics/Documents/Reposto%CC%81rios/DynamicFront/node_modules/@google/generative-ai/dist/index.mjs:432:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
    at async makeRequest (file:///Users/giovanics/Documents/Reposto%CC%81rios/DynamicFront/node_modules/@google/generative-ai/dist/index.mjs:401:9)
    at async generateContent (file:///Users/giovanics/Documents/Reposto%CC%81rios/DynamicFront/node_modules/@google/generative-ai/dist/index.mjs:865:22)
    at async ChatSession.sendMessage (file:///Users/giovanics/Documents/Reposto%CC%81rios/DynamicFront/node_modules/@google/generative-ai/dist/index.mjs:1208:9)
    at async GeminiProvider.generateContent (file:///Users/giovanics/Documents/Reposto%CC%81rios/DynamicFront/server/services/ai/providers/GeminiProvider.js:114:26)
    at async RequestQueue.process (file:///Users/giovanics/Documents/Reposto%CC%81rios/DynamicFront/server/services/ai/ModelManager.js:228:29) {
  status: 400,
  statusText: 'Bad Request',
  errorDetails: [
    {
      '@type': 'type.googleapis.com/google.rpc.BadRequest',
      fieldViolations: [Array]
    }
  ]
}

=== Result ===
Text Response: I encountered an error processing your request: [GoogleGenerativeAI Error]: Error fetching from https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent: [400 Bad Request] Invalid value at 'tools[0].function_declarations[15].parameters.properties[6].value.items.required' (TYPE_STRING), false
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[15].parameters.properties[6].value.items.items': Cannot find field.
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[26].parameters.properties[7].value.items': Cannot find field.
Invalid JSON payload received. Unknown name "$ref" at 'tools[0].function_declarations[54].parameters.properties[3].value.items': Cannot find field. [{"@type":"type.googleapis.com/google.rpc.BadRequest","fieldViolations":[{"field":"tools[0].function_declarations[15].parameters.properties[6].value.items.required","description":"Invalid value at 'tools[0].function_declarations[15].parameters.properties[6].value.items.required' (TYPE_STRING), false"},{"field":"tools[0].function_declarations[15].parameters.properties[6].value.items.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[15].parameters.properties[6].value.items.items': Cannot find field."},{"field":"tools[0].function_declarations[26].parameters.properties[7].value.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[26].parameters.properties[7].value.items': Cannot find field."},{"field":"tools[0].function_declarations[54].parameters.properties[3].value.items","description":"Invalid JSON payload received. Unknown name \"$ref\" at 'tools[0].function_declarations[54].parameters.properties[3].value.items': Cannot find field."}]}]
Gathered Data: []
